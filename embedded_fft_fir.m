acc = [894.20076, 1051.7552, 1051.7552, 996.342812, 999.820984, 999.820984, 989.654485, 989.654485, 1043.618704, 1039.698514, 1039.698514, 1025.129748, 1025.129748, 1117.407714, 1143.034995, 1143.034995, 1217.89121, 1217.89121, 1145.735572, 988.346599, 988.346599, 820.756358, 820.756358, 1049.550856, 1009.583082, 1042.047024, 1042.047024, 1060.77566, 1252.057906, 1252.057906, 1191.245567, 1191.245567, 1070.064017, 1214.359914, 1214.359914, 1184.518468, 1184.518468, 1080.744651, 797.260309, 797.260309, 868.268968, 868.268968, 1027.418123, 2092.268864, 2092.268864, 1934.018097, 1934.018097, 1748.623173, 1347.406769, 1347.406769, 1030.386821, 1030.386821, 837.268177, 1523.010506, 1783.504415, 1783.504415, 1866.797793, 1866.797793, 1427.253657, 1281.254854, 1281.254854, 1227.55285, 1227.55285, 994.033199, 1088.614716, 1088.614716, 1331.564869, 1331.564869, 1702.171848, 1734.087945, 1734.087945, 1736.502231, 1736.502231, 1244.859028, 1198.075123, 1198.075123, 1153.179084, 1153.179084, 918.773639, 858.580806, 858.580806, 756.717252, 629.648315, 453.06291, 483.76854, 626.176493, 626.176493, 637.36175, 637.36175, 1109.544952, 1228.674082, 1228.674082, 1345.761123, 1345.761123, 1799.457974, 1897.432476, 1897.432476, 1691.837463, 1691.837463, 1384.517606, 1418.519298, 1418.519298, 1441.152317, 1094.847935, 1094.847935, 1084.955299, 1084.955299, 1029.735888, 1300.911988, 1300.911988, 1221.524048, 1330.214268, 1330.214268, 1887.339397, 1627.461213, 1627.461213, 1440.528028, 1440.528028, 1203.537287, 1052.576838, 1052.576838, 886.644799, 886.644799, 432.965357, 351.071218, 351.071218, 203.366664, 203.366664, 173.127121, 508.257809, 508.257809, 601.938535, 601.938535, 695.95474, 1027.646826, 1027.646826, 1062.254678, 1062.254678, 1103.433732, 2103.895672, 2043.156871, 2043.156871, 1990.233655, 1990.233655, 1211.565516, 1129.187761, 1129.187761, 1143.386636, 1143.386636, 892.301519, 943.842148, 943.842148, 1098.623229, 1098.623229, 1870.095987, 2014.422994, 2014.422994, 2060.934254, 2060.934254, 1563.827676, 1342.116984, 1342.116984, 1153.549739, 1153.549739, 1038.133421, 1010.480084, 1010.480084, 886.420893, 775.43923, 176.229963, 176.229963, 376.461153, 376.461153, 552.758537, 565.627086, 565.627086, 633.499013, 633.499013, 744.592506, 1186.663811, 1186.663811, 1258.071938, 1258.071938, 1097.186402, 1557.937739, 1557.937739, 1713.752316, 1713.752316, 1579.548353, 1452.388378, 1452.388378, 1500.194987, 1500.194987, 1291.486353, 1425.214019, 1425.214019, 1139.596859, 714.258357, 714.258357, 2166.738332, 1806.243893, 1806.243893, 1720.09709, 1720.09709, 1652.37405, 1590.14339, 1590.14339, 1571.458558, 1571.458558, 1069.366635, 916.290893, 916.290893, 564.610485, 564.610485, 682.574538, 494.645327, 494.645327, 573.791774, 573.791774, 754.352703, 368.739746, 368.739746, 142.481578, 232.776717, 232.776717, 459.531283, 499.788955, 499.788955, 556.3569, 556.3569, 914.453389, 1070.209793, 1070.209793, 1189.353186, 1189.353186, 2140.944184, 1849.497499, 1849.497499, 1883.658674, 1883.658674, 1177.007222, 1069.037417, 1069.037417, 1139.945613, 1139.945613, 1453.6578, 1526.944007, 1526.944007, 1441.8717, 1441.8717, 1456.427478, 1619.254767, 1759.09238, 1759.09238, 1656.798419, 1382.621062, 1382.621062, 1118.214201, 1118.214201, 878.8373, 1030.407201, 1030.407201, 1028.362776, 1028.362776, 869.415896, 1599.234192, 1599.234192, 2120.144571, 2120.144571, 2056.728956, 1211.799076, 1211.799076, 1457.436448, 1457.436448, 1507.945954, 913.151685, 913.151685, 724.65785, 724.65785, 704.291133, 1838.345452, 1982.954362, 1982.954362, 2073.616647, 2073.616647, 1839.765474, 1731.0699, 1731.0699, 1657.750584, 1657.750584, 1129.876542, 1198.978732, 1198.978732, 1231.536439, 1231.536439, 516.309984, 378.272389, 378.272389, 340.826936, 340.826936, 542.864624, 525.133316, 525.133316, 505.782562, 505.782562, 565.873661, 1624.698434, 1624.698434, 1500.853424, 1456.898075, 1456.898075, 1157.623859, 992.283226, 992.283226, 1165.104716, 1165.104716, 1028.424523, 1078.069107, 1078.069107, 1098.002277, 1098.002277, 1037.781287, 1110.261681, 1110.261681, 1196.652832, 1196.652832, 1285.760086, 1383.367269, 1383.367269, 1541.537868, 1820.380455, 1820.380455, 1612.944202, 1612.944202, 1432.472687, 1063.808723, 1063.808723, 1026.868054, 981.72705, 981.72705, 1174.557363, 1117.725369, 1117.725369, 1038.585095, 1038.585095, 1206.158779, 1342.118847, 1342.118847, 1603.799551, 1603.799551, 1459.959931, 1079.491084, 1079.491084, 835.280791, 835.280791, 1332.574201, 1178.409946, 1178.409946, 1132.347561, 1132.347561, 938.06503, 666.201921, 666.201921, 574.9313, 574.9313, 1014.125239, 990.681079, 1055.78549, 1055.78549, 1178.748913, 1178.748913, 1518.745864, 1465.943382, 1465.943382, 1322.170186, 1322.170186, 1563.469539, 1664.342813, 1664.342813, 1701.566925, 1027.094446, 1027.094446, 1167.391537, 1167.391537, 1241.119253, 1005.738037, 1005.738037, 1004.932336, 1004.932336, 968.237058, 947.292457, 947.292457, 1009.272015, 1009.272015, 1005.61076, 1059.991038, 1016.599233, 1016.599233, 1124.964888, 1124.964888, 1389.061914, 1376.084663, 1376.084663, 1394.143823, 1394.143823, 1404.2895, 1239.338533, 1239.338533, 1149.345031, 1149.345031, 1319.17929, 1301.854831, 1301.854831, 1398.448068, 1398.448068, 1614.884516, 1750.32597, 1750.32597, 1910.585774, 1910.585774, 1353.458533, 1271.005114, 1271.005114, 1265.990521, 1282.055381, 857.155178, 857.155178, 724.332106, 724.332106, 708.834254, 399.270585, 399.270585, 339.141563, 339.141563, 314.178293, 314.178293, 273.038459, 276.436249, 276.436249, 429.058271, 429.058271, 931.055852, 958.347014, 958.347014, 965.287004, 965.287004, 1335.967065, 1361.05033, 1361.05033, 1368.012427, 1499.324181, 1416.619215, 1304.809948, 1173.44365, 1173.44365, 1126.269506, 1176.918434, 1176.918434, 1219.664298, 1219.664298, 1255.569194, 1640.367642, 1640.367642, 1746.466433, 1746.466433, 1862.655094, 1512.685361, 1512.685361, 1362.655129, 1362.655129, 1214.590466, 928.567176, 928.567176, 953.684958, 953.684958, 1044.455839, 1042.343513, 1042.343513, 988.60002, 988.60002, 1076.345669, 1545.294147, 1566.253172, 1566.253172, 1510.39763, 1510.39763, 1310.117934, 1399.881781, 1399.881781, 1380.333293, 1380.333293, 1095.869518, 1000.766706, 1000.766706, 904.894469, 904.894469, 611.039279, 780.058331, 780.058331, 849.104234, 849.104234, 1456.069023, 1626.847258, 1626.847258, 1891.176353, 1891.176353, 2065.124451, 1975.451594, 1975.451594, 1825.960843, 1750.623318, 1350.529526, 1350.529526, 1157.311972, 1157.311972, 1045.60987, 554.098367, 554.098367, 474.299483, 474.299483, 411.400049, 411.400049, 398.55489, 397.206495, 397.206495, 551.089829, 551.089829, 1011.835955, 959.532178, 959.532178, 867.9591, 867.9591, 1339.716388, 1387.850857, 1387.850857, 1436.126039, 1411.167247, 1313.660915, 1156.745434, 1148.518176, 1148.518176, 1166.407733, 1187.977273, 1187.977273, 1349.679962, 1349.679962, 1333.998501, 1384.154254, 1384.154254, 1432.901253, 1432.901253, 1467.372141, 1107.269615, 1107.269615, 1158.490397, 1158.490397, 1311.186867, 1467.154048, 1467.154048, 1451.037215, 1451.037215, 1422.163844, 1650.475386, 1650.475386, 1617.861861, 1517.160835, 1517.160835, 1073.980447, 1014.71326, 1014.71326, 974.124222, 974.124222, 589.109497, 564.942475, 564.942475, 548.906185, 548.906185, 438.758476, 513.118895, 513.118895, 537.461627, 537.461627, 927.882536, 848.295939, 848.295939, 881.55204, 881.55204, 1038.33954, 1786.164046, 1786.164046, 1901.309549, 1901.309549, 1781.193701, 1250.347552, 1015.395982, 1015.395982, 1190.71911, 1529.759458, 1529.759458, 1539.798688, 1539.798688, 1423.733472, 1253.191925, 1253.191925, 1349.234598, 1349.234598, 1307.517878, 525.407461, 525.407461, 666.577827, 666.577827, 969.793277, 969.793277, 1357.327153, 1209.065755, 1209.065755, 996.145572, 996.145572, 917.406126, 878.319987, 878.319987, 892.965285, 997.814612, 1585.848984, 1597.662355, 1596.109645, 1596.109645, 1565.692818, 1690.846238, 1690.846238, 1531.719948, 1531.719948, 1353.5483, 1026.371278, 1026.371278, 1060.906216, 1060.906216, 1033.095349, 1200.505727, 1200.505727, 1270.988985, 1270.988985, 1455.996223, 1712.702543, 1712.702543, 1768.488903, 1768.488903, 1791.314043, 1185.666901, 1185.666901, 975.847324, 802.71726, 802.71726, 454.391901, 440.600726, 440.600726, 529.556418, 529.556418, 1186.639372, 1309.631246, 1309.631246, 1507.229578, 1507.229578, 1753.871432, 1760.741321, 1760.741321, 1685.830656, 1685.830656, 1375.423571, 1312.831292, 1312.831292, 1196.875098, 1196.875098, 1334.54599, 1978.813028, 1978.813028, 2113.358701, 2113.358701, 2295.642394, 1773.336404, 1095.672396, 1095.672396, 691.647309, 2858.799398, 2858.799398, 2859.72691, 2859.72691, 2586.128187, 1731.954099, 1731.954099, 2195.322528, 2195.322528, 2206.784992, 771.063551, 771.063551, 486.700113, 486.700113, 830.136133, 2500.150995, 2500.150995, 2564.518473, 2564.518473, 2447.82577, 1264.560793, 1264.560793, 1170.546881, 1170.546881, 1218.420289, 1922.138393, 2036.026768, 2036.026768, 1999.866996, 1999.866996, 1211.001652, 1082.069776, 1082.069776, 1031.04898, 1031.04898, 1022.420657, 975.545488, 975.545488, 1002.562218, 1002.562218, 1638.551189, 1677.315116, 1677.315116, 1637.1408, 1637.1408, 1879.605012, 2107.714165, 2107.714165, 2123.207479, 2123.207479, 1631.700034, 1648.149265, 1648.149265, 1600.957214, 1552.568517, 2168.510549, 2168.510549, 2039.495281, 2039.495281, 1197.641432, 938.546216, 938.546216, 643.436089, 643.436089, 415.360085, 1306.490719, 1306.490719, 1594.451943, 1594.451943, 2006.843043, 2004.144206, 2004.144206, 1736.69341, 1736.69341, 1486.448452, 792.97604, 792.97604, 939.056974, 939.056974, 1050.80255, 1419.293838, 1419.293838, 1690.66762, 2241.007809, 2241.007809, 2048.388147, 1672.525635, 1672.525635, 1415.497792, 1415.497792, 625.570939, 701.457055, 701.457055, 1328.982317, 1328.982317, 2563.940132, 2384.344564, 2384.344564, 2174.464072, 2174.464072, 1128.664255, 1116.825859, 1116.825859, 1186.882892, 1186.882892, 1165.35574, 1625.208294, 1625.208294, 2160.645505, 2348.046848, 2072.914374, 1636.489536, 1309.933204, 1309.933204, 1006.360273, 1061.753738, 1061.753738, 1258.396202, 1258.396202, 1666.698233, 1702.298152, 1702.298152, 1727.838245, 1727.838245, 1946.731106, 1905.997377, 1905.997377, 1849.432616, 1849.432616, 1783.563568, 1629.881284, 1629.881284, 1318.260217, 1318.260217, 877.451423, 1234.324107, 1234.324107, 1235.447287, 1101.303319, 2309.594986, 2167.819642, 1749.577663, 1749.577663, 1267.16613, 489.944895, 489.944895, 720.297855, 720.297855, 840.010119, 1964.236493, 1964.236493, 2449.221917, 2449.221917, 2702.015174, 2255.558689, 2255.558689, 2241.432355, 2241.432355, 1860.185743, 1263.329332, 1263.329332, 1916.668203, 1916.668203, 2540.985242, 1791.357586, 1791.357586, 2051.218175, 2008.11653, 2008.11653, 1460.839142, 820.943969, 820.943969, 483.203891, 483.203891, 1057.369377, 304.965572, 304.965572, 1667.982614, 1667.982614, 2283.167975, 2054.944038, 2054.944038, 1245.073492, 1245.073492, 2472.693673, 1650.458118, 1650.458118, 1242.731669, 1242.731669, 2117.23924, 2084.237031, 2084.237031, 2064.54983, 2064.54983, 967.40891, 1102.871706, 1599.201676, 1753.690965, 2229.62979, 2566.578462, 2566.578462, 2629.762917, 2629.762917, 2211.369937, 1896.323021, 1896.323021, 1478.382224, 1478.382224, 1081.519302, 1784.312473, 1784.312473, 1008.530614, 1008.530614, 1352.003698, 2071.464458, 2071.464458, 2029.81009, 2029.81009, 2037.584845, 1912.434574, 1912.434574, 1499.993667, 1499.993667, 1556.808916, 1136.934915, 1136.934915, 1838.992659, 2393.637191, 2393.637191, 2025.298003, 2027.090033, 2027.090033, 2068.377142, 2068.377142, 1507.301562, 920.637822, 920.637822, 1015.331473, 1015.331473, 615.086173, 1265.928908, 1265.928908, 1920.219258, 1920.219258, 1648.751649, 1564.175182, 1564.175182, 1562.52008, 1562.52008, 2118.366588, 1983.42658, 1983.42658, 1868.039079, 1631.39756, 948.197237, 620.511885, 526.416185, 526.416185, 728.164817, 645.071314, 645.071314, 790.520714, 790.520714, 987.099792, 1273.846537, 1273.846537, 1247.191244, 1247.191244, 1259.912695, 1266.863844, 1266.863844, 1169.935041, 1169.935041, 1157.422136, 1104.160767, 1104.160767, 984.14125, 984.14125, 1221.124072, 1630.212563, 1630.212563, 1252.595306, 1175.84948, 1175.84948, 1196.088207, 1351.338596, 1351.338596, 1491.27127, 1491.27127, 1458.813216, 1291.072422, 1291.072422, 1170.530649, 1170.530649, 1284.312657, 1302.32638, 1302.32638, 1286.526331, 1286.526331, 1158.77953, 1047.754265, 1047.754265, 1032.470339, 1032.470339, 1004.18574, 1039.920189, 1039.920189, 1084.780162, 1084.780162, 1532.923351, 1512.04861, 1395.538964, 1395.538964, 1423.059029, 2007.782359, 2007.782359, 1897.346832, 1897.346832, 1669.822446, 1488.6158, 1488.6158, 1485.065992, 1485.065992, 1332.591835, 1426.383188, 1426.383188, 1445.343904, 1445.343904, 1215.938321, 1401.77352, 1401.77352, 1681.959869, 1681.959869, 2104.318655, 1817.584661, 1817.584661, 1460.678609, 1460.678609, 1370.846454, 1326.398884, 1383.223048];


fs = 100;
n =  1024;
t = 0:1/fs:(n-1)/fs;

% 1, 
figure(1)
plot(t, acc)
xlabel('time(s)')
ylabel('acc(t)')

% 2, (mbed) input acc
y = [1331662.500000, 109120.234375, 60189.296875, 7422.741211, 4319.734375, 42885.019531, 28097.566406, 16909.617188, 12793.177734, 6912.208984, 57674.671875, 22099.292969, 11920.631836, 2492.814697, 51635.640625, 44548.695312, 2205.821533, 7462.564941, 29881.423828, 35408.335938, 30411.845703, 53417.652344, 42380.414062, 85895.398438, 68800.398438, 32812.062500, 6989.093750, 12132.068359, 14394.405273, 43441.148438, 13209.303711, 33874.488281, 7007.150391, 30721.214844, 25078.968750, 10919.159180, 33620.890625, 50616.468750, 25310.023438, 10047.213867, 11403.479492, 39604.480469, 11473.742188, 40751.921875, 48637.566406, 28849.341797, 51565.339844, 52021.816406, 49634.894531, 29922.611328, 33659.632812, 30024.181641, 41001.363281, 15553.993164, 8872.899414, 21733.689453, 1554.574707, 29409.814453, 18324.103516, 17060.375000, 23056.414062, 18869.769531, 35756.601562, 32156.482422, 8923.885742, 35519.031250, 19811.878906, 3391.141602, 37778.132812, 14753.554688, 16590.109375, 23730.072266, 10782.255859, 19201.152344, 40832.492188, 52432.367188, 41938.156250, 31472.316406, 49503.398438, 24063.132812, 12402.756836, 28963.759766, 16987.113281, 42093.246094, 24016.500000, 25030.408203, 15974.223633, 28592.625000, 21477.591797, 21682.296875, 15425.730469, 22734.923828, 23267.044922, 7379.272461, 14842.419922, 4997.576172, 20258.119141, 7267.405762, 14734.337891, 24850.726562, 28241.394531, 15699.385742, 15031.035156, 12266.287109, 3853.314453, 14300.235352, 11125.179688, 12693.795898, 13579.354492, 7473.387695, 14933.924805, 4513.798340, 8530.714844, 16119.833984, 8477.487305, 9064.871094, 9693.628906, 26413.218750, 13114.338867, 17263.806641, 12648.465820, 9668.125000, 12592.591797, 21571.484375, 3708.623047, 9051.833008, 4376.018066, 10654.919922, 23512.468750, 6229.063965, 26024.861328, 18943.945312, 17416.880859, 15882.851562, 5181.152832, 6703.297852, 3394.092773, 12285.343750, 14750.924805, 5476.523926, 19219.302734, 14835.008789, 6039.106934, 4511.866699, 12331.870117, 6743.474609, 4070.566895, 6740.437988, 5332.191406, 7307.083496, 13810.549805, 8965.511719, 21170.375000, 10880.956055, 11561.706055, 12296.453125, 14276.703125, 10673.008789, 6272.352539, 8993.196289, 11181.409180, 3858.007324, 12667.151367, 11022.814453, 12057.199219, 2408.958008, 4144.415039, 13091.356445, 4797.853516, 5120.443359, 3476.667725, 11226.123047, 11852.726562, 12008.208984, 8524.211914, 16066.666992, 4116.933594, 7800.160645, 4391.646484, 9460.528320, 9610.468750, 5754.018066, 3523.178223, 5484.276855, 8740.859375, 3587.565674, 8694.811523, 3625.460449, 3678.605225, 3642.566162, 10782.969727, 7558.807129, 12086.605469, 13665.439453, 8450.163086, 7984.953613, 4062.397705, 6019.083984, 557.914307, 5919.460938, 2962.885254, 1145.538330, 3989.567871, 9422.190430, 3312.128662, 1969.912720, 3740.086670, 5429.605469, 3126.346191, 4968.083984, 3362.090332, 1207.370728, 5932.523438, 5646.033691, 2708.887695, 5130.114746, 6978.795410, 2662.084229, 3657.067383, 3883.195801, 6637.492188, 7456.708008, 7755.762207, 3939.850342, 9477.971680, 3132.514404, 4640.639160, 8563.268555, 3934.573730, 5025.536621, 3282.643555, 1871.286011, 7155.895020, 5293.209473, 5657.891602, 10200.893555, 8317.145508, 3907.684326, 6665.411621, 8875.893555, 3465.690918, 6395.523926, 1221.706177, 3784.953125, 4665.260254, 5018.484863, 4036.732666, 4807.312500, 7310.345215, 5803.101074, 11067.553711, 6580.824219, 6405.093750, 1940.119507, 10524.729492, 5267.202637, 2769.471191, 3599.577637, 5238.349121, 2930.654053, 7056.821777, 3861.168213, 2024.349976, 6293.521973, 5901.496094, 7814.026367, 2695.367188, 7790.985840, 4124.965332, 4742.455078, 7476.795410, 5620.669922, 7343.474121, 2463.286133, 5676.792969, 4694.889160, 5582.296387, 8478.086914, 4419.057617, 7341.746582, 6637.423340, 7625.452148, 5510.557617, 7772.636719, 7376.833008, 6423.003418, 3133.608643, 2934.214600, 7537.273926, 6336.532715, 9667.132812, 5732.159668, 1741.221069, 4770.839355, 7694.146973, 2773.680664, 8291.213867, 6939.439453, 3250.890625, 5691.581543, 2950.469971, 3146.758789, 6888.169434, 3855.456299, 8042.600098, 8088.495117, 7242.163086, 6312.088867, 1254.643066, 1180.492676, 1654.397217, 6867.787109, 1867.622925, 3440.821533, 4695.809570, 2113.177734, 8908.664062, 2961.288086, 4214.948730, 2266.456299, 3105.929199, 2702.960449, 5722.501465, 6000.144043, 4411.132324, 8910.112305, 1326.333618, 7822.182129, 7911.071289, 5707.286621, 6641.207520, 7304.718750, 3070.239258, 5316.224121, 8651.852539, 5361.078613, 6728.748047, 2848.633057, 3061.980469, 2119.571533, 1840.168701, 6507.265137, 6675.170898, 1361.939697, 6049.222656, 8881.330078, 3903.810303, 5013.556641, 4249.895996, 5697.357422, 2446.326172, 3770.533203, 1840.208130, 8010.222168, 3112.270508, 7643.584473, 4981.809082, 1406.288208, 7593.574707, 6156.294922, 5034.031250, 2256.448975, 922.923035, 8840.346680, 2804.360596, 3058.251953, 4907.467773, 786.878357, 2503.782471, 3305.312012, 1090.353638, 4326.777344, 2534.044678, 2092.633057, 900.390076, 1675.932739, 4331.221680, 5747.810547, 2221.807373, 6052.015137, 2541.787842, 2129.947266, 847.993530, 2147.222656, 4354.442871, 3306.948242, 2997.807617, 1790.461548, 3709.707520, 3125.998779, 3370.751221, 2820.857910, 3488.168457, 7048.735840, 6298.617188, 4478.756348, 1598.181885, 5982.633789, 3823.683838, 4811.113281, 5264.253418, 986.091064, 4397.234375, 4697.589355, 4812.520508, 902.854004, 3550.633545, 5135.468262, 5416.469238, 3436.755127, 2208.066406, 941.308716, 2216.226318, 2168.276367, 4471.593750, 2567.928955, 2823.592773, 3456.808838, 3743.830566, 3387.868164, 2501.332764, 3378.912598, 2517.903564, 2889.179199, 3778.254883, 3278.395996, 617.324951, 7333.839844, 5273.090332, 2989.208984, 1634.239868, 3226.059326, 5593.848145, 2761.721924, 5312.640625, 1991.470947, 5767.310059, 4528.672852, 3496.685547, 7030.614746, 11054.983398, 5004.794434, 707.243958, 1985.260864, 4082.675293, 4772.730469, 5942.033203, 6993.116211, 2108.914062, 3631.190186, 1664.243530, 5093.586426, 1756.031616, 6103.737305, 2229.314453, 9085.419922, 4799.411621, 7597.273926, 1457.394165, 2303.841064, 4187.523438, 7411.301270, 4029.826172, 6274.113281, 1748.388916, 9829.907227, 2095.759277, 664.672302, 5729.297363, 5665.496094, 4524.782227, 4238.636719, 1405.905029, 7832.926270, 7704.893555, 2547.655029, 2973.986816, 5099.124512, 5945.870605, 3519.426025, 5386.160645, 3055.282715, 3810.018555, 6258.004395, 2547.985596, 6430.621582, 7860.292480, 1921.308716, 2309.199951, 4751.296387, 1239.320679, 5156.250488, 777.072632, 2909.687500, 2289.061035, 6655.588867, 5418.982422, 4257.399902, 487.780670, 2555.593018, 4856.931641, 1855.192261, 3544.802490, 2904.625000, 4700.356934, 4806.554688, 3289.746338, 3798.974854, 5438.090332, 4563.293457, 7021.413086, 9643.558594, 5878.062500, 9643.555664, 7021.416504, 4563.294434, 5438.089355, 3798.976318, 3289.748291, 4806.553223, 4700.355957, 2904.626221, 3544.799805, 1855.189453, 4856.932129, 2555.593018, 487.780670, 4257.396973, 5418.982422, 6655.587891, 2289.059326, 2909.686523, 777.072205, 5156.251953, 1239.320435, 4751.293457, 2309.197998, 1921.309814, 7860.291504, 6430.619629, 2547.983643, 6258.003418, 3810.020508, 3055.282227, 5386.160645, 3519.424316, 5945.869141, 5099.124023, 2973.987305, 2547.657959, 7704.894531, 7832.925781, 1405.906006, 4238.638184, 4524.779297, 5665.495117, 5729.295410, 664.674927, 2095.762207, 9829.908203, 1748.388306, 6274.115234, 4029.825195, 7411.299805, 4187.527832, 2303.840820, 1457.392700, 7597.271973, 4799.412109, 9085.419922, 2229.314453, 6103.737305, 1756.032349, 5093.585938, 1664.244019, 3631.193359, 2108.914062, 6993.117188, 5942.031738, 4772.731934, 4082.676270, 1985.263184, 707.243286, 5004.793945, 11054.985352, 7030.614746, 3496.684082, 4528.671875, 5767.314941, 1991.469971, 5312.638672, 2761.722412, 5593.847656, 3226.057129, 1634.240845, 2989.206299, 5273.087402, 7333.840820, 617.325439, 3278.395996, 3778.252441, 2889.176514, 2517.905518, 3378.910400, 2501.334473, 3387.867188, 3743.829346, 3456.806152, 2823.592773, 2567.925537, 4471.592773, 2168.276611, 2216.226318, 941.308472, 2208.065674, 3436.753174, 5416.470703, 5135.468262, 3550.632568, 902.852783, 4812.522949, 4697.590820, 4397.233887, 986.089417, 5264.253906, 4811.111816, 3823.684814, 5982.632324, 1598.180786, 4478.758301, 6298.619629, 7048.734375, 3488.167236, 2820.859375, 3370.752197, 3126.000000, 3709.708496, 1790.461914, 2997.806396, 3306.943359, 4354.442871, 2147.226318, 847.994080, 2129.945557, 2541.789307, 6052.015625, 2221.808838, 5747.811523, 4331.221680, 1675.931030, 900.390442, 2092.633301, 2534.044922, 4326.777832, 1090.354248, 3305.311523, 2503.782715, 786.876160, 4907.467773, 3058.249756, 2804.359375, 8840.345703, 922.921570, 2256.448975, 5034.027344, 6156.293945, 7593.573242, 1406.288696, 4981.808105, 7643.585938, 3112.269531, 8010.226562, 1840.208496, 3770.531250, 2446.326904, 5697.358398, 4249.895020, 5013.555664, 3903.809082, 8881.330078, 6049.222656, 1361.941650, 6675.171387, 6507.265625, 1840.170288, 2119.571289, 3061.980957, 2848.634521, 6728.747559, 5361.079590, 8651.851562, 5316.225586, 3070.238037, 7304.719238, 6641.207031, 5707.288574, 7911.071289, 7822.184570, 1326.334229, 8910.112305, 4411.131836, 6000.146484, 5722.500488, 2702.961426, 3105.929443, 2266.457520, 4214.948730, 2961.287842, 8908.663086, 2113.176758, 4695.810059, 3440.823486, 1867.623901, 6867.788574, 1654.398315, 1180.491089, 1254.642944, 6312.087891, 7242.163574, 8088.496582, 8042.600098, 3855.460449, 6888.166016, 3146.763184, 2950.470947, 5691.580078, 3250.891357, 6939.438477, 8291.212891, 2773.680420, 7694.146973, 4770.836914, 1741.222412, 5732.157715, 9667.133789, 6336.528809, 7537.273438, 2934.214111, 3133.606934, 6423.001953, 7376.833496, 7772.636719, 5510.557129, 7625.448730, 6637.420410, 7341.748047, 4419.057129, 8478.087891, 5582.296387, 4694.891113, 5676.791992, 2463.285156, 7343.474121, 5620.670898, 7476.793457, 4742.453613, 4124.968262, 7790.987305, 2695.369629, 7814.028809, 5901.496094, 6293.521973, 2024.349121, 3861.170654, 7056.822754, 2930.653809, 5238.349609, 3599.580322, 2769.471191, 5267.203613, 10524.731445, 1940.118774, 6405.091797, 6580.823242, 11067.553711, 5803.103516, 7310.344727, 4807.314941, 4036.733154, 5018.482910, 4665.260742, 3784.952881, 1221.706665, 6395.528809, 3465.690674, 8875.893555, 6665.412109, 3907.684570, 8317.146484, 10200.894531, 5657.893555, 5293.211914, 7155.895020, 1871.286133, 3282.644531, 5025.538086, 3934.572754, 8563.272461, 4640.637695, 3132.513916, 9477.972656, 3939.850586, 7755.760742, 7456.708984, 6637.494629, 3883.193604, 3657.067383, 2662.082275, 6978.795410, 5130.115234, 2708.887939, 5646.034180, 5932.524414, 1207.369141, 3362.092529, 4968.089355, 3126.347168, 5429.606445, 3740.085449, 1969.913452, 3312.128418, 9422.190430, 3989.570068, 1145.538086, 2962.885498, 5919.462891, 557.914978, 6019.083496, 4062.396240, 7984.954590, 8450.162109, 13665.439453, 12086.605469, 7558.806641, 10782.968750, 3642.564697, 3678.606445, 3625.458496, 8694.811523, 3587.565430, 8740.859375, 5484.277832, 3523.178955, 5754.017090, 9610.468750, 9460.531250, 4391.646484, 7800.161133, 4116.934082, 16066.667969, 8524.212891, 12008.206055, 11852.724609, 11226.126953, 3476.668457, 5120.443848, 4797.854492, 13091.356445, 4144.415039, 2408.958984, 12057.202148, 11022.816406, 12667.150391, 3858.009033, 11181.409180, 8993.196289, 6272.353027, 10673.006836, 14276.703125, 12296.453125, 11561.706055, 10880.954102, 21170.376953, 8965.509766, 13810.551758, 7307.084473, 5332.191895, 6740.439941, 4070.565674, 6743.474121, 12331.870117, 4511.867676, 6039.108398, 14835.008789, 19219.302734, 5476.522461, 14750.924805, 12285.341797, 3394.091797, 6703.296875, 5181.153320, 15882.853516, 17416.880859, 18943.945312, 26024.857422, 6229.058594, 23512.468750, 10654.919922, 4376.017578, 9051.832031, 3708.621094, 21571.480469, 12592.590820, 9668.125977, 12648.463867, 17263.804688, 13114.339844, 26413.218750, 9693.626953, 9064.869141, 8477.488281, 16119.831055, 8530.714844, 4513.799805, 14933.926758, 7473.385742, 13579.353516, 12693.793945, 11125.179688, 14300.233398, 3853.313965, 12266.287109, 15031.034180, 15699.385742, 28241.396484, 24850.726562, 14734.338867, 7267.406250, 20258.119141, 4997.577637, 14842.420898, 7379.272949, 23267.044922, 22734.923828, 15425.730469, 21682.296875, 21477.587891, 28592.625000, 15974.225586, 25030.406250, 24016.500000, 42093.246094, 16987.111328, 28963.755859, 12402.756836, 24063.136719, 49503.394531, 31472.316406, 41938.156250, 52432.363281, 40832.492188, 19201.152344, 10782.256836, 23730.074219, 16590.109375, 14753.556641, 37778.125000, 3391.139893, 19811.876953, 35519.027344, 8923.886719, 32156.484375, 35756.601562, 18869.769531, 23056.414062, 17060.378906, 18324.103516, 29409.816406, 1554.574707, 21733.691406, 8872.901367, 15553.996094, 41001.359375, 30024.179688, 33659.632812, 29922.613281, 49634.894531, 52021.816406, 51565.335938, 28849.343750, 48637.558594, 40751.921875, 11473.742188, 39604.480469, 11403.481445, 10047.213867, 25310.021484, 50616.468750, 33620.886719, 10919.160156, 25078.968750, 30721.216797, 7007.150391, 33874.488281, 13209.304688, 43441.148438, 14394.404297, 12132.070312, 6989.092773, 32812.062500, 68800.390625, 85895.390625, 42380.414062, 53417.652344, 30411.845703, 35408.339844, 29881.421875, 7462.567383, 2205.821533, 44548.695312, 51635.640625, 2492.813721, 11920.632812, 22099.292969, 57674.667969, 6912.211426, 12793.176758, 16909.617188, 28097.570312, 42885.019531, 4319.735840, 7422.741211, 60189.289062, 109120.226562];
y0 = fftshift(y);         
f0 = (-n/2:n/2-1)*(fs/n); 
power0 = abs(y0);    

figure(2)
plot(f0,power0)
xlabel('f(Hz)')
ylabel('Abs(X)')

% 3,
h = fir1(28, 1/10, "high");
figure(3);
stem(h);

% 4, 
figure(4);
freqz(h);


% 5, (mbed) input acc 
sprintf('%.10f, ',h)
% x_filtered = fir(acc)
x_filtered = [1.544160, 3.434751, 5.467330, 7.119146, 7.278511, 3.855508, -5.965909, -25.321297, -57.097229, -103.595314, -165.695389, -242.654922, -331.938721, -429.341553, 362.772644, 421.878906, 331.302887, 196.904739, 135.092896, 84.047180, 36.198586, 9.085206, 43.616249, 25.519814, 13.801403, -10.932461, -19.576248, 66.419884, 90.016129, 91.221878, 171.685074, 181.641632, 122.188263, -21.449568, -9.643902, -168.977264, -166.450729, 57.893009, 7.188421, 23.407339, 3.636793, 1.109973, 172.082443, 157.578033, 88.309906, 86.806755, -28.191771, 127.355469, 140.777084, 122.055511, 125.325325, 12.821899, -295.160706, -335.019836, -317.516388, -379.690704, -284.646423, 719.919495, 672.977356, 484.324799, 471.064758, 288.155823, -99.780350, -82.960770, -383.703064, -373.802551, -563.874329, 117.072624, 370.899567, 366.311798, 451.520935, 463.372772, 45.250771, -72.492378, -40.947292, -65.841125, -45.667027, -270.946991, -183.775681, -203.872131, 9.353143, -22.916313, 316.974701, 327.772247, 321.266968, 334.584534, 363.552368, -80.479515, -65.728729, 7.331422, 42.464954, 124.757095, -28.066978, -12.672375, 54.567482, 7.640220, -79.512955, -234.727234, -202.880737, -81.320152, -123.477142, -175.020309, -254.524857, 123.691078, 142.141754, 40.860729, 62.194191, -21.142548, 366.022949, 418.688507, 395.915314, 190.327332, 210.061829, -60.146816, 20.581968, 72.657806, 146.494598, -153.777100, -119.867073, -109.731331, -104.573761, -169.385513, 79.622177, 48.149277, -66.318092, 8.825157, -17.101107, 525.528503, 269.652832, 293.148651, 150.649612, 214.900253, 60.875107, 6.711395, 112.480995, 55.295559, 160.366959, -197.577408, -199.464401, -137.210205, -244.933578, -228.587341, -266.966431, 37.102058, -16.033360, 5.043734, -84.717545, -94.619873, 122.457977, 2.396379, -82.414124, -194.841309, -251.246643, 670.479736, 559.770935, 538.873657, 494.197968, 528.593750, -195.087494, -213.727051, -150.375076, -83.128403, -49.705055, -292.441010, -259.917633, -302.865570, -208.585571, -277.011902, 425.109985, 512.190552, 474.803131, 508.781158, 522.807373, 68.148560, -88.282578, -4.656345, -95.865166, 8.761508, 1.065410, 79.299835, 179.019791, 145.568451, 113.290382, -422.530457, -376.854156, -150.708649, -145.005493, 15.634106, -6.298357, -58.795704, -58.431507, -136.768219, -111.760010, 239.740295, 150.053009, 134.700729, 53.748787, -179.866486, 218.745895, 172.330612, 294.351440, 275.676727, 137.217194, 18.873217, 37.599976, 110.087029, 136.393051, -49.203682, 98.496704, 100.783806, -195.059402, -642.587341, -675.450073, 735.601257, 337.401337, 305.006775, 199.149551, 197.206650, 148.860641, 128.638428, 191.159027, 253.236435, 347.248199, -52.587933, -102.579582, -2.594098, -260.235992, -176.211060, 12.733908, -113.557083, -61.363163, 61.739277, 98.531448, 309.261383, -51.907593, -34.450893, -253.097855, -167.689087, -185.734406, 6.645534, -5.881683, -76.088066, -106.992119, -209.364624, 35.105484, 72.746529, -43.775181, -32.838509, -126.099625, 751.748718, 412.473450, 389.118500, 422.140442, 438.718689, -239.355606, -316.193787, -288.040863, -198.073883, -190.776245, 115.784676, 171.010330, 145.510239, 32.595860, 8.126072, 4.884302, 163.769714, 314.154785, 340.495972, 277.684265, 53.951946, 107.217262, -105.178978, -61.923344, -272.370575, -112.175591, -125.529602, -161.034119, -210.934448, -429.399231, 237.346313, 183.703934, 664.301575, 645.145020, 586.243652, -229.749054, -184.473785, 116.966339, 174.284622, 273.353424, -289.821655, -284.172363, -493.137909, -539.009460, -624.468628, 429.956451, 494.020416, 420.894318, 454.834900, 421.040558, 181.792374, 95.574707, 143.809128, 141.869217, 231.269791, -192.193390, -11.693623, 105.176964, 253.611710, 364.715881, -249.019821, -300.370178, -232.783295, -225.767471, -207.518585, -14.606062, -67.789352, -127.057732, -223.401794, -311.190552, -340.672882, 632.040161, 559.686279, 380.380890, 299.558899, 282.583771, -16.469109, -168.966827, -148.126465, 48.488369, 71.425568, -46.009258, 16.035318, 20.782915, 37.866539, 27.232870, -53.437721, -9.322889, -45.002594, -1.135508, -48.233154, -7.076752, 45.418037, 7.805475, 139.252502, 405.952057, 411.230713, 225.757935, 261.438080, 127.740417, -188.304871, -136.261673, -126.860893, -135.150970, -111.729240, 89.870354, 29.008465, 12.806847, -90.180519, -117.728073, 22.836340, 136.663010, 122.563499, 378.935974, 383.496979, 253.436523, -105.272171, -79.001465, -292.591614, -259.802155, 271.000122, 152.569412, 188.872467, 178.529892, 212.049515, 46.852333, -202.999878, -190.987823, -282.923431, -297.967834, 111.237564, 44.940098, 56.474781, -3.397692, 56.479408, -6.045292, 275.499298, 172.884171, 133.371185, -37.764015, -52.337627, 187.394730, 299.489166, 322.567657, 392.476837, -241.523987, -197.552582, -11.998874, 32.598995, 147.627914, -50.726696, -20.166061, 3.215801, 20.966362, -3.778596, -18.611515, -18.632147, 36.900299, 24.394669, 1.618463, 31.856588, -40.359333, -73.170929, 0.533517, -33.344139, 199.641251, 161.237106, 142.234421, 147.999023, 142.289062, 151.357681, -13.211116, -14.431684, -109.902374, -122.651947, 25.535114, -22.032953, -58.569450, -1.893805, -39.856728, 144.553970, 259.201691, 254.182220, 427.086243, 459.044220, -46.834145, -62.223946, 17.944756, 102.945213, 214.830902, -111.362762, -14.476071, -53.047760, 35.084023, 100.402145, -137.081146, -76.403107, -87.661507, -53.644615, -60.787437, -59.441265, -116.630852, -146.996674, -197.286377, -109.936600, -185.980011, 230.610458, 169.100067, 79.903366, 1.353483, -76.176079, 226.999084, 198.847336, 159.756485, 141.943832, 261.039764, 177.000122, 69.997009, -54.018463, -49.327713, -97.585632, -58.146446, -80.063507, -69.082596, -108.069893, -114.364662, 229.204529, 196.143356, 281.483032, 276.906403, 405.863800, 87.070984, 133.489410, 41.307995, 104.868141, 21.128685, -205.300903, -156.240753, -95.453407, -75.511772, 18.435564, 3.207029, -24.157328, -116.191803, -161.475647, -122.251999, 299.739105, 279.775482, 248.743988, 173.946716, 169.044983, -20.742735, 94.324692, 132.986740, 162.809113, 219.781128, -4.153177, -40.663849, 10.442707, -46.746281, -26.139462, -321.335327, -179.225494, -230.270691, -234.996964, -326.389618, 177.402756, 242.297089, 143.128693, 322.546692, 260.095947, 398.991608, 305.250275, 331.892914, 238.529190, 244.426773, -53.055145, 62.572418, -6.173507, 119.386360, 129.562195, -249.541824, -151.667480, -149.603210, -87.754623, -109.562332, -90.022278, -103.836639, -125.583206, -163.167068, -61.615067, -124.536346, 264.348877, 136.882019, 60.700138, -103.810272, -170.076630, 243.438828, 245.209076, 210.786118, 236.381531, 199.164551, 97.649124, -58.596664, -64.293007, -62.732288, -46.248268, -30.706406, -40.337639, 108.768829, 96.073845, 69.595467, 111.687447, 108.600639, 158.534363, 162.779190, 202.331299, -153.309799, -153.864395, -109.161201, -122.387764, 10.189882, 141.140839, 113.791222, 71.797943, 51.657959, 12.352726, 242.631729, 259.982971, 260.902161, 209.428772, 272.261444, -95.619331, -71.915611, 14.615839, 60.656513, 143.196823, -166.268875, -125.708023, -72.485741, -49.464745, -24.983866, -125.935593, -58.187252, -81.045425, -95.640808, -150.461472, 170.300079, 9.347216, -81.868576, -144.627182, -239.666733, -170.791443, 500.198059, 440.992096, 515.190308, 492.514557, 365.991791, -159.706787, -382.195160, -366.543365, -175.719070, 177.071106, 190.812225, 216.895035, 237.668945, 150.878632, 19.278315, 66.449768, 216.378967, 272.550476, 283.914459, -452.007080, -418.287170, -256.012512, -247.708847, 52.467010, 42.250927, 415.061005, 251.975296, 236.846924, 8.736280, -8.568526, -109.377846, -178.631607, -218.173553, -252.724503, -203.772018, 323.648529, 277.602600, 225.977310, 188.762863, 138.403275, 261.896271, 279.289459, 152.982162, 196.389725, 66.431961, -213.893906, -176.284286, -116.752266, -107.921829, -144.356674, -2.996163, -42.278923, -18.956457, -67.136810, 75.739738, 303.221252, 294.751862, 365.691437, 405.764771, 492.676300, -28.208769, 67.904167, -42.461143, -122.987778, -47.026627, -343.306580, -335.875824, -346.900360, -300.012451, -369.002014, 197.826401, 220.631912, 119.807442, 223.213043, 143.886093, 331.053955, 300.243683, 281.614868, 202.460144, 206.487137, -98.498596, -157.903931, -164.439529, -297.251221, -322.984924, -218.508957, 387.603668, 350.492767, 448.787262, 412.755035, 556.610535, -9.119286, -735.407471, -791.536560, -1255.004150, 850.096313, 803.014771, 774.165527, 771.005310, 527.258240, -262.464996, -173.117828, 398.043701, 511.041229, 624.597412, -731.456238, -686.024963, -959.369873, -980.784851, -681.046509, 928.831177, 871.655823, 889.481323, 859.815979, 732.522217, -441.330475, -421.722961, -490.263245, -463.679657, -391.389618, 335.696991, 475.301849, 506.346893, 510.366364, 561.540466, -166.738571, -229.231201, -163.001572, -155.965118, -113.636795, -99.382423, -148.588913, -175.421112, -197.567642, -264.716370, 289.471436, 242.271042, 156.563019, 36.612125, -32.568508, 154.041397, 341.275055, 315.324371, 316.952545, 313.103821, -174.051163, -145.994492, -127.453896, -146.732239, -155.734848, 511.691101, 578.526489, 529.422058, 617.353210, -133.294052, -310.032898, -246.081238, -501.409729, -492.083069, -741.665649, 99.837723, 33.764423, 248.230347, 181.571930, 544.708862, 517.259094, 519.790039, 279.854462, 324.274353, 126.594620, -517.985718, -487.003662, -332.196533, -348.706116, -275.298462, 36.748600, -22.714504, 193.772552, 705.252563, 689.778870, 507.324310, 161.649094, 204.505447, -8.001048, 25.991713, -747.221924, -680.716553, -713.263794, -137.262589, -194.898956, 983.597229, 763.966675, 744.212036, 537.415833, 560.802917, -446.915039, -418.534180, -384.903046, -294.433075, -290.985748, -322.362000, 117.235855, 96.719536, 617.093323, 803.941162, 543.899963, 138.170853, -147.924469, -105.400177, -371.972382, -291.895538, -285.669281, -103.364098, -136.968857, 222.126694, 199.600998, 139.384796, 109.415848, 63.578613, 250.449005, 197.954971, 204.866043, 172.910263, 212.701584, 197.381866, 98.157585, 150.945496, -114.999634, -82.179932, -504.164337, -141.099030, -143.095367, -145.458267, -278.193573, 939.355347, 820.987793, 437.355255, 476.022003, 28.688250, -728.430847, -735.096191, -543.261230, -613.215820, -593.404297, 410.608246, 283.169250, 646.938477, 546.880737, 728.412720, 242.818756, 233.506577, 234.814392, 266.185425, -76.491051, -634.521545, -601.559692, 75.840240, 98.520882, 750.094849, 38.759926, 93.769447, 427.643250, 479.543427, 588.186829, 157.768829, -368.380310, -274.905121, -547.036987, -517.980774, 46.683128, -747.560852, -821.109802, 447.085266, 346.204742, 864.451416, 551.405762, 483.545105, -373.311157, -405.028778, 803.112976, -24.836609, -27.060764, -433.260681, -431.797028, 440.274017, 405.323059, 399.934875, 366.123413, 343.650909, -786.234680, -695.050354, -252.695465, -155.749786, 264.685089, 554.733887, 528.079407, 587.429932, 610.782104, 242.828186, -1.398130, 82.868622, -246.049835, -165.071976, -496.313141, 249.695099, 268.150665, -512.567993, -537.447449, -231.968628, 443.852051, 404.498383, 333.410736, 317.290314, 323.421539, 208.477722, 223.605682, -173.393661, -165.027664, -110.091324, -545.103821, -573.006348, 96.176361, 619.851135, 601.009338, 231.834213, 255.674530, 303.119476, 414.255066, 499.627563, 30.808168, -467.748383, -395.210052, -250.497879, -226.997040, -629.411682, -7.453518, -55.538490, 536.067017, 469.039032, 133.641846, -6.789241, -48.088711, -71.243256, -69.714706, 512.868347, 432.394989, 509.773193, 490.771942, 363.418671, -204.229263, -422.225800, -420.005524, -345.794434, -96.225243, -158.780197, -165.297470, -49.301121, -94.964134, 46.760784, 276.203674, 224.607437, 155.089310, 122.884827, 115.183884, 113.061707, 112.219131, 19.460333, 24.574232, 15.312532, -38.295826, -43.529881, -173.776398, -188.029907, 31.190498, 420.528961, 401.756073, 7.287161, -84.736336, -97.449394, -86.850746, 61.558338, 58.188450, 197.561432, 200.075119, 172.934677, 13.243504, 23.782885, -83.492828, -68.347176, 61.800613, 98.855743, 120.018227, 126.605736, 149.677872, 44.852470, -44.606121, -27.349150, -32.087570, -30.109886, -67.213432, -52.303921, -85.483025, -85.576630, -140.646652, 243.764374, 156.325806, -26.166054, -87.471916, -112.365097, 431.122009, 405.983307, 285.969421, 291.452789, 82.617416, -69.356728, -34.818790, -1.658048, 32.401627, -91.494179, 20.574600, 27.968891, 43.023781];
figure(5)
plot(t, x_filtered);
xlabel('time(s)')
ylabel('x-filtered')

% 6, (mbed) input x_filtered
% y_filtered = fft(x_filtered)
y_filtered = [45729.324219, 3567.834961, 2775.893555, 821.416443, 948.734375, 2462.534668, 1078.776123, 280.315887, 604.984131, 952.407104, 2745.353760, 909.242676, 718.268066, 1374.661011, 4327.127441, 2589.768555, 1193.535889, 2003.358276, 1481.301392, 2762.644775, 2477.535156, 7275.024902, 5085.951660, 13482.191406, 8719.243164, 4578.646973, 2618.452148, 4125.273926, 4825.776367, 6801.508789, 4472.765137, 9243.694336, 2940.247070, 9921.686523, 4806.708496, 5313.183105, 7045.084473, 15975.685547, 6758.577148, 3303.030029, 1962.193848, 14347.817383, 2965.155029, 13907.552734, 20374.257812, 14506.524414, 20888.503906, 23804.513672, 20814.003906, 10833.320312, 13368.751953, 17881.949219, 18236.496094, 11280.398438, 7967.734863, 10373.159180, 2526.742676, 18513.087891, 8232.511719, 7627.736328, 11648.112305, 9148.489258, 23862.822266, 20175.236328, 8806.322266, 26449.416016, 16866.386719, 4818.401367, 25059.970703, 9474.967773, 14669.757812, 20322.750000, 10009.912109, 15230.789062, 32751.675781, 45171.335938, 35237.593750, 23779.343750, 40584.609375, 22261.517578, 12752.770508, 25292.687500, 17019.589844, 36610.472656, 19404.857422, 20674.503906, 12630.791992, 27805.804688, 21268.113281, 18753.433594, 13092.491211, 22796.003906, 23418.541016, 6241.169434, 15258.263672, 5149.394531, 19085.410156, 8144.163574, 13273.780273, 23349.128906, 28012.646484, 16181.108398, 14366.730469, 11382.332031, 3202.620117, 13474.114258, 10677.242188, 12573.692383, 13401.631836, 7060.436523, 14966.036133, 4356.794922, 8470.860352, 16701.681641, 8909.403320, 8402.126953, 8888.220703, 26310.308594, 12411.016602, 17755.773438, 13501.947266, 10276.216797, 13417.826172, 21377.759766, 2454.062744, 8941.138672, 4762.147949, 9526.167969, 23704.955078, 7657.069336, 24835.447266, 19540.828125, 18438.005859, 15094.337891, 4457.694336, 8252.055664, 3264.226074, 10646.298828, 14601.237305, 4036.609619, 18600.195312, 15054.366211, 5678.612305, 5996.916504, 14276.657227, 4770.207520, 3609.475830, 8765.216797, 5563.229004, 5847.329590, 15872.287109, 9840.192383, 19300.902344, 12896.517578, 13007.727539, 12447.435547, 14321.606445, 9452.320312, 5220.262207, 7185.640625, 12129.370117, 2947.748291, 13759.805664, 11178.456055, 11531.843750, 1570.958862, 3448.096191, 11260.389648, 5448.352051, 7027.461426, 5307.932617, 12374.633789, 11233.269531, 10211.094727, 7515.813477, 15901.262695, 4634.169922, 9269.641602, 3337.951660, 9127.728516, 8285.789062, 4185.492188, 4295.295410, 6980.312012, 9820.190430, 2528.717041, 7855.385254, 5040.390625, 5046.880859, 4973.511230, 11275.309570, 6307.984863, 11287.143555, 13795.152344, 9301.570312, 8916.964844, 5323.299805, 5285.514160, 793.746948, 5923.835449, 2279.698975, 611.727417, 3427.983398, 8441.033203, 2128.458740, 864.277649, 4331.014160, 6417.683594, 3155.784912, 3825.295166, 3126.286377, 1740.061646, 5076.030273, 4575.101074, 3472.019043, 6260.770020, 8109.448730, 3668.864014, 4489.224121, 3331.869141, 6142.954590, 6714.577148, 8085.535156, 4284.989258, 8579.299805, 4013.521484, 3728.349121, 9504.925781, 5015.388672, 3947.654053, 3217.785645, 1550.304810, 7292.461914, 5695.659180, 6662.793457, 10574.874023, 7505.658203, 4691.499023, 5751.127441, 8558.274414, 2638.348145, 7191.425781, 2020.227173, 3225.667480, 4443.826660, 5451.943359, 3416.136230, 3927.191162, 7397.802246, 6615.757324, 10416.872070, 6451.534180, 7181.408203, 1499.335449, 10310.728516, 5946.884277, 2502.173828, 4183.625977, 5940.126953, 2281.104004, 6746.467773, 3565.280273, 2630.866943, 6891.811523, 6426.608887, 7168.813477, 3320.012207, 8381.763672, 4657.136230, 4101.021973, 7102.821777, 5386.479004, 6979.453125, 3096.583252, 6291.250000, 4686.991699, 4988.402344, 7765.322266, 4411.080078, 7974.664062, 6043.914551, 7066.427734, 6257.195801, 7857.053711, 6615.212402, 6104.445801, 3959.394287, 3748.268555, 8378.843750, 7099.535645, 8791.021484, 5167.903809, 2637.629883, 5013.251465, 8594.851562, 3715.005127, 7440.837891, 6152.576172, 3516.895752, 4768.596680, 3162.849121, 4076.507324, 5853.621582, 3837.596436, 9017.507812, 8648.949219, 6462.501953, 5500.014648, 1919.258301, 1827.408936, 2722.136963, 7905.517090, 2022.085327, 4166.233398, 5688.140137, 1241.142334, 7842.810547, 3412.793701, 4858.403320, 1350.983887, 2076.461670, 1732.831543, 4941.878906, 5148.798828, 5329.192871, 9671.253906, 1152.689331, 6981.011230, 6963.605469, 5550.825195, 7468.536621, 7939.947754, 2826.462158, 5807.553223, 8489.268555, 4706.414551, 6843.725098, 3392.693115, 2380.080322, 1597.437256, 2303.077881, 5850.808105, 6022.061523, 925.391785, 6690.099609, 9473.580078, 4240.090332, 4448.469727, 3654.800781, 5260.210938, 2923.113525, 4106.465820, 2425.418701, 7488.708984, 2868.478760, 8112.671875, 4584.518066, 1920.743164, 7757.809082, 5735.375977, 5551.363770, 2733.400635, 1486.433472, 8627.060547, 2935.583984, 2804.573486, 5348.705078, 1410.648071, 1877.846802, 2621.878662, 1777.446533, 3976.792969, 2961.588379, 2724.349121, 783.345581, 2011.876099, 3723.110352, 5077.532715, 2472.394531, 6811.776367, 3145.019775, 2071.944092, 364.764374, 1337.775513, 5165.903809, 3741.882812, 2593.700439, 2314.403564, 3060.202881, 2353.312988, 3818.271484, 3656.477295, 3290.740234, 6255.052246, 5715.063965, 3667.734131, 2203.661377, 6762.652344, 4178.979980, 4241.781738, 4674.291992, 1063.687500, 4637.318359, 4589.955566, 5604.770996, 1681.098999, 3872.874023, 4298.087891, 5387.406250, 3593.376221, 1463.425537, 1757.969727, 2558.402832, 1690.286499, 4623.929199, 2318.724365, 3635.728271, 3002.177734, 4481.151367, 2777.667725, 1674.290405, 3074.417236, 3326.824707, 3496.794434, 3393.850586, 2512.489990, 1274.041260, 7647.889648, 5095.688965, 3523.031250, 1621.461182, 2323.922607, 5263.336426, 1974.743774, 4525.150879, 2989.246338, 6772.520996, 5136.314941, 3401.051025, 6077.203613, 10098.266602, 5066.183105, 1297.048706, 3076.782471, 4613.472168, 5610.282227, 4893.137695, 6274.591309, 3281.673584, 4326.882324, 1487.593628, 4493.394043, 798.480652, 7223.928223, 1418.065552, 7881.902832, 5930.853516, 8174.161133, 1201.366089, 3182.165283, 3428.644531, 6099.883301, 4628.104980, 6912.575684, 715.869080, 9238.226562, 997.072693, 1868.320923, 6983.531250, 4406.904297, 3258.894531, 5335.214844, 1851.643311, 6584.469238, 7053.410645, 3668.951172, 1769.385376, 4439.608887, 7067.850098, 4649.866211, 5627.858887, 2242.532471, 2717.006836, 6398.789062, 3534.335205, 5538.169922, 7168.819824, 2854.777100, 2293.163330, 3854.564941, 1393.567993, 5932.784668, 340.353424, 3657.259766, 2360.168213, 5937.562012, 5738.419922, 4846.470215, 719.268372, 2746.441406, 4942.492188, 2122.874023, 3119.097900, 2707.244629, 4844.407715, 4500.289551, 2968.092041, 3579.293457, 5525.398438, 4695.610352, 7179.522461, 9572.353516, 5676.636719, 9572.353516, 7179.521484, 4695.611328, 5525.400391, 3579.292969, 2968.092285, 4500.290527, 4844.407715, 2707.244629, 3119.098633, 2122.873535, 4942.492676, 2746.441162, 719.268433, 4846.469238, 5738.419922, 5937.562012, 2360.167725, 3657.260010, 340.354767, 5932.784668, 1393.568359, 3854.565430, 2293.162842, 2854.776611, 7168.818359, 5538.169434, 3534.335449, 6398.788574, 2717.007080, 2242.532471, 5627.859863, 4649.866211, 7067.849609, 4439.608398, 1769.384644, 3668.953613, 7053.409668, 6584.470215, 1851.642212, 5335.215820, 3258.894531, 4406.907715, 6983.531250, 1868.321167, 997.071594, 9238.227539, 715.868652, 6912.576172, 4628.107422, 6099.882812, 3428.645752, 3182.164062, 1201.365967, 8174.159668, 5930.853027, 7881.903809, 1418.065552, 7223.926270, 798.479858, 4493.392578, 1487.594482, 4326.881836, 3281.674072, 6274.590820, 4893.137207, 5610.281250, 4613.472168, 3076.782471, 1297.049072, 5066.184570, 10098.266602, 6077.204590, 3401.050537, 5136.317383, 6772.520508, 2989.246338, 4525.151367, 1974.743774, 5263.336426, 2323.920654, 1621.462158, 3523.031250, 5095.688477, 7647.891602, 1274.041992, 2512.491699, 3393.851562, 3496.795166, 3326.824951, 3074.417236, 1674.291260, 2777.667725, 4481.151367, 3002.177979, 3635.728027, 2318.724121, 4623.928223, 1690.286865, 2558.402344, 1757.969971, 1463.425903, 3593.374512, 5387.406250, 4298.088867, 3872.874756, 1681.101318, 5604.770508, 4589.955078, 4637.318359, 1063.685913, 4674.292480, 4241.781738, 4178.979004, 6762.651367, 2203.660400, 3667.734375, 5715.064453, 6255.050781, 3290.740234, 3656.477295, 3818.271729, 2353.312988, 3060.201904, 2314.404785, 2593.700928, 3741.883789, 5165.903809, 1337.776367, 364.764862, 2071.943115, 3145.019775, 6811.774902, 2472.394775, 5077.532227, 3723.109375, 2011.876831, 783.346008, 2724.350586, 2961.589111, 3976.794434, 1777.446289, 2621.878418, 1877.847290, 1410.647949, 5348.705078, 2804.572266, 2935.585205, 8627.061523, 1486.433716, 2733.400146, 5551.365234, 5735.376465, 7757.809570, 1920.744141, 4584.516602, 8112.673340, 2868.479004, 7488.709473, 2425.418945, 4106.466309, 2923.112549, 5260.210938, 3654.800049, 4448.470215, 4240.090332, 9473.580078, 6690.099121, 925.389893, 6022.062012, 5850.805176, 2303.078369, 1597.438477, 2380.080566, 3392.691406, 6843.726562, 4706.416504, 8489.267578, 5807.554199, 2826.460449, 7939.948242, 7468.536133, 5550.824707, 6963.605469, 6981.010254, 1152.688843, 9671.253906, 5329.191895, 5148.799316, 4941.878418, 1732.831909, 2076.461914, 1350.986572, 4858.402832, 3412.793945, 7842.809082, 1241.142822, 5688.140137, 4166.232910, 2022.084839, 7905.518555, 2722.136230, 1827.410522, 1919.256714, 5500.016602, 6462.500977, 8648.948242, 9017.508789, 3837.596436, 5853.621094, 4076.505127, 3162.848633, 4768.598145, 3516.895508, 6152.576660, 7440.838379, 3715.004883, 8594.851562, 5013.251465, 2637.629395, 5167.904785, 8791.022461, 7099.534180, 8378.843750, 3748.268799, 3959.394043, 6104.445801, 6615.210938, 7857.054199, 6257.194824, 7066.426758, 6043.914551, 7974.663086, 4411.081543, 7765.321289, 4988.402344, 4686.991699, 6291.250488, 3096.584961, 6979.453125, 5386.479492, 7102.821289, 4101.021973, 4657.136230, 8381.761719, 3320.012207, 7168.813477, 6426.608398, 6891.812012, 2630.866211, 3565.281006, 6746.465332, 2281.102783, 5940.125977, 4183.625977, 2502.173828, 5946.884766, 10310.729492, 1499.335815, 7181.409668, 6451.535156, 10416.872070, 6615.757812, 7397.802734, 3927.190674, 3416.136230, 5451.942383, 4443.826660, 3225.667480, 2020.227051, 7191.425781, 2638.348145, 8558.273438, 5751.127930, 4691.499023, 7505.658203, 10574.874023, 6662.792969, 5695.661621, 7292.462891, 1550.304688, 3217.787842, 3947.652100, 5015.389648, 9504.924805, 3728.349854, 4013.520996, 8579.299805, 4284.989258, 8085.535645, 6714.577148, 6142.954590, 3331.868408, 4489.223633, 3668.864258, 8109.448242, 6260.768555, 3472.019043, 4575.103027, 5076.030762, 1740.061523, 3126.286133, 3825.298340, 3155.784912, 6417.685059, 4331.014648, 864.277710, 2128.456543, 8441.033203, 3427.983398, 611.727295, 2279.698486, 5923.835449, 793.747070, 5285.514160, 5323.300293, 8916.964844, 9301.569336, 13795.153320, 11287.143555, 6307.985352, 11275.309570, 4973.511230, 5046.878418, 5040.391113, 7855.385742, 2528.715820, 9820.191406, 6980.314941, 4295.297363, 4185.492188, 8285.792969, 9127.729492, 3337.952637, 9269.641602, 4634.169434, 15901.263672, 7515.812988, 10211.092773, 11233.268555, 12374.635742, 5307.933105, 7027.457520, 5448.351074, 11260.389648, 3448.095703, 1570.958618, 11531.843750, 11178.456055, 13759.805664, 2947.748535, 12129.369141, 7185.639648, 5220.262207, 9452.320312, 14321.606445, 12447.437500, 13007.726562, 12896.516602, 19300.902344, 9840.193359, 15872.287109, 5847.329590, 5563.229004, 8765.216797, 3609.476807, 4770.206543, 14276.656250, 5996.915527, 5678.612793, 15054.364258, 18600.197266, 4036.609863, 14601.237305, 10646.298828, 3264.224609, 8252.055664, 4457.693848, 15094.337891, 18438.005859, 19540.826172, 24835.447266, 7657.068848, 23704.955078, 9526.167969, 4762.148926, 8941.138672, 2454.062744, 21377.759766, 13417.827148, 10276.214844, 13501.947266, 17755.775391, 12411.015625, 26310.306641, 8888.220703, 8402.126953, 8909.402344, 16701.681641, 8470.860352, 4356.794922, 14966.037109, 7060.436035, 13401.630859, 12573.690430, 10677.242188, 13474.115234, 3202.620117, 11382.333984, 14366.729492, 16181.108398, 28012.648438, 23349.128906, 13273.778320, 8144.163574, 19085.412109, 5149.394531, 15258.264648, 6241.169922, 23418.541016, 22796.003906, 13092.491211, 18753.433594, 21268.113281, 27805.806641, 12630.791992, 20674.503906, 19404.857422, 36610.472656, 17019.589844, 25292.687500, 12752.770508, 22261.519531, 40584.609375, 23779.343750, 35237.589844, 45171.335938, 32751.675781, 15230.789062, 10009.913086, 20322.750000, 14669.757812, 9474.967773, 25059.970703, 4818.402344, 16866.384766, 26449.414062, 8806.322266, 20175.236328, 23862.824219, 9148.490234, 11648.114258, 7627.736816, 8232.511719, 18513.087891, 2526.742188, 10373.159180, 7967.733887, 11280.396484, 18236.496094, 17881.951172, 13368.751953, 10833.319336, 20814.003906, 23804.513672, 20888.503906, 14506.523438, 20374.255859, 13907.552734, 2965.155029, 14347.816406, 1962.194458, 3303.031494, 6758.578125, 15975.685547, 7045.084473, 5313.186035, 4806.708496, 9921.685547, 2940.245850, 9243.693359, 4472.765137, 6801.510254, 4825.776855, 4125.273926, 2618.452148, 4578.647461, 8719.243164, 13482.192383, 5085.952637, 7275.024902, 2477.535156, 2762.645752, 1481.301758, 2003.358032, 1193.536133, 2589.769775, 4327.127441, 1374.660034, 718.268860, 909.241699, 2745.353760, 952.407471, 604.983887, 280.316986, 1078.775635, 2462.534668, 948.735413, 821.416870, 2775.893799, 3567.834473];
y_filtered0 = fftshift(y_filtered);         
power_filtered0 = abs(y_filtered0);    

figure(6)
plot(f0,power_filtered0)
xlabel('f(Hz)')
ylabel('Abs(X-filtered)')

